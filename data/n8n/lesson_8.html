<h1>Основные ноды и их использование</h1>

<p>Изучим основные ноды n8n, которые используются в большинстве workflow.</p>

<h2>Core Nodes (Базовые ноды)</h2>

<h3>1. Manual Trigger</h3>
<p>Запускает workflow вручную. Используется для тестирования.</p>
<ul>
    <li>Не требует настройки</li>
    <li>Генерирует один пустой элемент данных</li>
</ul>

<h3>2. Schedule Trigger</h3>
<p>Запускает workflow по расписанию (cron).</p>
<pre><code>Примеры расписания:
- Каждую минуту: * * * * *
- Каждый час: 0 * * * *
- Каждый день в 9:00: 0 9 * * *
- Каждый понедельник: 0 9 * * 1
</code></pre>

<h3>3. Webhook</h3>
<p>Принимает HTTP запросы извне.</p>
<ul>
    <li>Методы: GET, POST, PUT, DELETE</li>
    <li>Автоматически создает уникальный URL</li>
    <li>Можно настроить путь и параметры</li>
</ul>

<h3>4. Set</h3>
<p>Устанавливает значения в данных.</p>
<ul>
    <li>Можно добавлять новые поля</li>
    <li>Можно изменять существующие</li>
    <li>Поддерживает выражения</li>
</ul>

<h3>5. IF</h3>
<p>Условное ветвление — разделяет поток на "True" и "False".</p>
<pre><code>Пример условия:
{{ $json.temperature }} > 25
</code></pre>

<h3>6. Switch</h3>
<p>Множественное ветвление по условиям.</p>
<ul>
    <li>Можно добавить множество выходов</li>
    <li>Каждый выход имеет свое условие</li>
    <li>Есть выход "Fallback" для несоответствующих случаев</li>
</ul>

<h3>7. Merge</h3>
<p>Объединяет несколько потоков данных в один.</p>
<ul>
    <li>Режимы: Merge By Index, Merge By Key, Append</li>
    <li>Полезно для объединения результатов параллельных операций</li>
</ul>

<h3>8. Split In Batches</h3>
<p>Разбивает массив на батчи для обработки.</p>
<ul>
    <li>Указывается размер батча</li>
    <li>Полезно для обработки больших массивов</li>
</ul>

<h3>9. HTTP Request</h3>
<p>Отправляет HTTP запросы к внешним API.</p>
<ul>
    <li>Поддерживает все HTTP методы</li>
    <li>Можно передавать headers, body, query параметры</li>
    <li>Поддерживает аутентификацию</li>
</ul>

<h3>10. Code</h3>
<p>Выполняет пользовательский JavaScript код.</p>
<pre><code>// Пример кода
const items = [];
for (const item of $input.all()) {
  items.push({
    json: {
      processed: true,
      original: item.json
    }
  });
}
return items;
</code></pre>

<h2>Практические примеры</h2>

<h3>Пример 1: Простая обработка данных</h3>

<pre><code>Manual Trigger → Set (добавить данные) → 
IF (проверка условия) → Set (обработка) → HTTP Request
</code></pre>

<h3>Пример 2: Параллельная обработка</h3>

<pre><code>Webhook → Split In Batches → 
  ├─ HTTP Request 1
  ├─ HTTP Request 2
  └─ HTTP Request 3
→ Merge → Set (результат)
</code></pre>

<h3>Пример 3: Условная маршрутизация</h3>

<pre><code>Schedule Trigger → HTTP Request (получить данные) → 
Switch (по типу данных) →
  ├─ Обработка типа A
  ├─ Обработка типа B
  └─ Fallback (неизвестный тип)
</code></pre>

<h2>Работа с массивами</h2>

<h3>Обработка каждого элемента</h3>
<p>По умолчанию ноды обрабатывают все элементы массива. Для обработки каждого элемента отдельно используйте циклы или Split In Batches.</p>

<h3>Доступ к элементам массива</h3>
<pre><code>// Первый элемент
{{ $json.items[0] }}

// Все элементы (в цикле)
{{ $json.items }}
</code></pre>

<h2>Обработка ошибок</h2>

<p>Ноды могут иметь выход "Error" для обработки ошибок:</p>

<pre><code>HTTP Request → 
  ├─ Success (основной выход)
  └─ Error (обработка ошибок) → Set (логирование) → 
</code></pre>

<h2>Полезные функции</h2>

<p>n8n предоставляет множество встроенных функций:</p>

<ul>
    <li><code>{{ $now }}</code> — текущая дата и время</li>
    <li><code>{{ $today }}</code> — сегодняшняя дата</li>
    <li><code>{{ Math.random() }}</code> — случайное число</li>
    <li><code>{{ $json.field.toUpperCase() }}</code> — строковые методы</li>
    <li><code>{{ $json.array.length }}</code> — длина массива</li>
</ul>

<h2>Советы по использованию нод</h2>

<ul>
    <li>Используйте понятные имена для нод</li>
    <li>Группируйте связанные ноды визуально</li>
    <li>Комментируйте сложную логику</li>
    <li>Тестируйте каждую ноду отдельно</li>
    <li>Используйте IF и Switch для условной логики</li>
    <li>Применяйте Merge для объединения потоков</li>
</ul>

<p>В следующем уроке мы изучим переменные и выражения более подробно.</p>

